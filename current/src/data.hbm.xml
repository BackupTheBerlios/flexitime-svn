<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 2.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd">

<hibernate-mapping>
	<class name="fr.umlv.ir3.flexitime.common.data.impl.DataImpl" table="data" polymorphism="implicit">
    	<id name="idData" column="idData" unsaved-value="null">
			<generator class="native"/>
		</id>
		<property name="name" />

		<!-- Building -->
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.general.impl.BuildingImpl" table="building">
			<key column="idBuilding"/>
			<list name="lstFloor" cascade="all">
				<key column="idBuilding" />
				<index column="posFloor" />
				<one-to-many class="fr.umlv.ir3.flexitime.common.data.general.impl.FloorImpl" />
			</list>
		</joined-subclass>

		<!-- Floor -->    
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.general.impl.FloorImpl" table="floor">
			<key column="idFloor"/>
			<many-to-one name="parentBuilding" column="idBuilding" class="fr.umlv.ir3.flexitime.common.data.general.impl.BuildingImpl"/>
			<list name="lstRoom" cascade="all">
				<key column="idFloor" />
				<index column="posRoom" />      	
				<one-to-many class="fr.umlv.ir3.flexitime.common.data.resources.impl.RoomImpl" />
			</list>
		</joined-subclass>

		<!-- Track -->    
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.general.impl.TrackImpl" table="track">
			<key column="idTrack"/>
			<list name="lstClass" cascade="all" lazy="true">
				<key column="idTrack" />
				<index column="posClass" />      	
				<one-to-many class="fr.umlv.ir3.flexitime.common.data.general.impl.ClassImpl" />
			</list>
		</joined-subclass>

		<!-- Class -->
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.general.impl.ClassImpl" table="class">
			<key column="idClass"/>
			<many-to-one name="parentTrack" column="idTrack" class="fr.umlv.ir3.flexitime.common.data.general.impl.TrackImpl"/>
			<list name="lstGroups" cascade="all" lazy="true">
				<key column="idClass" />
				<index column="posGroup" />
				<one-to-many class="fr.umlv.ir3.flexitime.common.data.resources.impl.GroupImpl" />
			</list>
			<property name="teachingStructure" type="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.TeachingStructureImpl" column="idTeachingStructure"/>
		</joined-subclass>

		<!-- Resource -->    
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.resources.impl.ResourceImpl" table="resource">
			<key column="idResource"/>
			<list name="lstBusy" cascade="all" table="resourcebusylist">
				<key column="idResource" />
				<index column="posBusy" />
				<many-to-many class="fr.umlv.ir3.flexitime.common.data.activity.impl.BusyImpl" column="idBusy"/>
			</list>

			<!-- Room -->      
			<joined-subclass name="fr.umlv.ir3.flexitime.common.data.resources.impl.RoomImpl" table="room">
				<key column="idRoom"/>
				<property name="capacity"/>
				<property name="type"/>
			</joined-subclass>

			<!-- Device -->      
			<joined-subclass name="fr.umlv.ir3.flexitime.common.data.resources.impl.DeviceImpl" table="device">
				<key column="idDevice"/>
				<property name="type"/>
			</joined-subclass>

			<!-- Group -->      
			<joined-subclass name="fr.umlv.ir3.flexitime.common.data.resources.impl.GroupImpl" table="groupt">
				<key column="idGroup"/>
				<property name="nbPerson"/>
			</joined-subclass>

			<!-- Teacher -->      
			<joined-subclass name="fr.umlv.ir3.flexitime.common.data.resources.impl.TeacherImpl" table="teacher">
				<key column="idTeacher"/>
				<property name="email"/>
				<property name="firstName"/>
			</joined-subclass>
			
		</joined-subclass>
		
		<!-- Course -->      
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.CourseImpl" table="course">
			<key column="idCourse"/>
			<property name="color"/>
			<property name="defaultLength"/>
			<property name="nbHours"/>
			<property name="type"/>
			
			<many-to-one name="parentSubject" column="idSubject" class="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.SubjectImpl"/>
			
			<list name="lstTeacher" cascade="all" table="courseteacherlist">
				<key column="idCourse" />
				<index column="posTeacher" />
				<many-to-many class="fr.umlv.ir3.flexitime.common.data.resources.impl.TeacherImpl" column="idTeacher"/>
			</list>
			
		</joined-subclass>
		
		<!-- Subject -->      
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.SubjectImpl" table="subject">
			<key column="idSubject"/>
			
			<many-to-one name="parentSubjectsGroup" column="idSubjectsGroup" class="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.SubjectsGroupImpl"/>
			
			<list name="lstCourse" cascade="all">
				<key column="idSubject" />
				<index column="posCourse" />
				<one-to-many class="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.CourseImpl"/>
			</list>
			
		</joined-subclass>
		
		<!-- SubjectsGroup -->      
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.SubjectsGroupImpl" table="subjectsgroup">
			<key column="idSubjectsGroup"/>
			
			<many-to-one name="parentTeachStruct" column="idTeachingStructure" class="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.TeachingStructureImpl"/>
			
			<list name="lstSubject" cascade="all">
				<key column="idSubjectsGroup" />
				<index column="posSubject" />
				<one-to-many class="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.SubjectImpl"/>
			</list>
			
		</joined-subclass>
		
		<!-- TeachingStructure -->      
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.TeachingStructureImpl" table="teachingstructure">
			<key column="idTeachingStructure"/>

			<list name="lstSubjectsGroup" cascade="all">
				<key column="idTeachingStructure" />
				<index column="posSubjectsGroup" />
				<one-to-many class="fr.umlv.ir3.flexitime.common.data.teachingStructure.impl.SubjectsGroupImpl"/>
			</list>
			
		</joined-subclass>

	</class>

	<!-- BUSY -->
	<class name="fr.umlv.ir3.flexitime.common.data.activity.impl.BusyImpl" table="busy">
		<id name="idBusy" column="idBusy" unsaved-value="null">
			<generator class="native"/>
		</id>

		<property name="endDate" type="timestamp" />
		<property name="startDate" type="timestamp" />

		<!-- DeviceBusy -->
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.activity.impl.DeviceBusyImpl" table="devicebusy">
				<key column="idBusy"/>
				<property name="reason"/>
		</joined-subclass>
		
		<!-- GroupBusy -->
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.activity.impl.GroupBusyImpl" table="groupbusy">
				<key column="idBusy"/>
				<property name="reason"/>
		</joined-subclass>
		
		<!-- Lesson -->
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.activity.impl.LessonImpl" table="lesson">
				<key column="idBusy"/>
				<list name="lstResource" cascade="all" table="lessonresourcelist">
					<key column="idLesson" />
					<index column="posRes" />
					<many-to-many class="fr.umlv.ir3.flexitime.common.data.resources.impl.ResourceImpl" column="idResource"/>
				</list>
		</joined-subclass>
		
		<!-- RoomBusy -->
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.activity.impl.RoomBusyImpl" table="roombusy">
				<key column="idBusy"/>
				<property name="reason"/>
		</joined-subclass>
		
		<!-- TeacherBusy -->
		<joined-subclass name="fr.umlv.ir3.flexitime.common.data.activity.impl.TeacherBusyImpl" table="teacherbusy">
				<key column="idBusy"/>
				<property name="reason"/>
		</joined-subclass>
		
	</class>

</hibernate-mapping>
