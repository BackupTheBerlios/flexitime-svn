<?xml version="1.0" encoding="ISO-8859-1"?>
<project xmlns:j="jelly:core" xmlns:ant="jelly:ant" xmlns:u="jelly:util">
	
	<preGoal name="war:init">
		<ant:echoproperties destfile="${maven.build.dir}/${cvsname}/build.properties"/>
	</preGoal>
	
	<goal name="build-ear">
		<ant:delete dir="${cvsname}"/>
		<attainGoal name="clean"/>
		<attainGoal name="get-code"/>
		<attainGoal name="java:compile"/>
		<attainGoal name="war"/>
		<ear
			destfile="${maven.build.dir}/${cvsname}.ear"
			appxml="${base.dir}/${cvsname}/deploy/application.xml"
		>
			<fileset
				dir="${maven.build.dir}"
				includes="*.war"
			/>
		</ear>
	</goal>
	<goal name="get-code">
		<cvs dest="${base.dir}/" cvsRoot="${config.cvsroot}" package="${cvsname}"
			tag="${appversion}" />
	</goal>
	<goal name="jar">
		<attainGoal name="jar:jar"/>
		<move file="${maven.build.dir}/${maven.final.name}.jar" tofile="${basedir}/bin/${maven.final.name}.jar"/>
	</goal>
</project>